<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Deliverables Dashboard</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://miro.com/app/static/sdk/v2/miro.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <!-- Dependency Check Script -->
    <script>
        // Check if Supabase loaded correctly
        window.addEventListener('load', function() {
            console.log('🔍 Checking dependencies...');
            
            // Check Miro SDK
            if (typeof miro !== 'undefined') {
                console.log('✅ Miro SDK loaded');
            } else {
                console.warn('⚠️ Miro SDK not loaded');
            }
            
            // Check Supabase
            const hasSupabase = (
                (window.supabase && window.supabase.createClient) ||
                (typeof window.createClient === 'function') ||
                (window.Supabase && window.Supabase.createClient)
            );
            
            if (hasSupabase) {
                console.log('✅ Supabase JS loaded');
            } else {
                console.warn('⚠️ Supabase JS not loaded - Analytics will be disabled');
            }
        });
    </script>
    
    <script src="config.js"></script>
    <script src="miro-sdk-v2-improved.js"></script>
    <script src="miro-sdk-enhanced.js"></script>
    <script src="project-integration.js"></script>
    <script src="ceo-dashboard.js"></script>
    <script src="health-check.js"></script>
</head>
<body>
    <div id="app">
        <header class="app-header">
            <h2>📋 Deliverables</h2>
            <button id="add-deliverable" class="btn-primary">+ Add</button>
        </header>

        <div class="dashboard-content">
            <!-- Workload Alert -->
            <div id="workload-alert" class="alert alert-warning" style="display: none;">
                <span id="alert-message"></span>
            </div>

            <!-- Deliverables List -->
            <div id="deliverables-list" class="deliverables-container">
                <div class="loading">Loading deliverables...</div>
            </div>

            <!-- Collaborators Section -->
            <div class="collaborators-section">
                <h3>👥 Team Workload</h3>
                <div id="collaborators-list" class="collaborators-container">
                    <!-- Collaborators will be rendered here -->
                </div>
            </div>

            <!-- CEO Dashboard Section -->
            <div class="ceo-dashboard-section">
                <h3>📊 CEO Dashboard</h3>
                <div class="dashboard-container">
                    <!-- Quick Stats -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number" id="total-deliverables">-</div>
                            <div class="stat-label">Total Deliverables</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="completed-deliverables">-</div>
                            <div class="stat-label">Completed</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="in-progress-deliverables">-</div>
                            <div class="stat-label">In Progress</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="overdue-deliverables">-</div>
                            <div class="stat-label">Overdue</div>
                        </div>
                    </div>

                    <!-- Progress Chart -->
                    <div class="progress-section">
                        <h4>📈 Project Progress</h4>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
                        </div>
                        <div class="progress-text">
                            <span id="progress-percentage">0%</span> Complete
                        </div>
                    </div>

                    <!-- Team Performance -->
                    <div class="team-performance">
                        <h4>👥 Team Performance</h4>
                        <div id="team-performance-list">
                            <!-- Team performance will be rendered here -->
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="recent-activity">
                        <h4>🕒 Recent Activity</h4>
                        <div id="recent-activity-list">
                            <!-- Recent activity will be rendered here -->
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="ceo-actions">
                        <button id="generate-report-btn" class="btn-primary">
                            📋 Generate Report
                        </button>
                        <button id="export-data-btn" class="btn-secondary">
                            📤 Export Data
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="app-footer">
            <div class="sync-status">
                <span id="sync-indicator" class="sync-indicator">●</span>
                <span id="sync-text">Synced</span>
            </div>
        </footer>
    </div>

    <script src="app.js"></script>
</body>
</html>